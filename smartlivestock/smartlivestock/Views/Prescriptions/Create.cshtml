
@model smartlivestock.Models.PrescriptionViewModel

@{
    ViewData["Title"] = "Create";
}

<style>
    table {
        width: 100%;
    }

    td {
        padding: 8px;
    }

    th {
        padding: 8px;
    }
</style>

<div class="container mt-4">
    <h4 class="text-center text-primary">প্রেসক্রিপশন তৈরি করুন</h4>

    <div class="row justify-content-center">
        <form asp-action="Create" class="col-12 bg-light bg-gradient p-4 border" enctype="multipart/form-data">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>

            <div class="form-group">
                <label asp-for="SinglePrescrip.RegistrationId" class="control-label">রেজি নং---নাম-----মোবাইল</label>
                <select id="selectedCustOriId" asp-for="SinglePrescrip.RegistrationId" class="form-control select2" asp-items="ViewBag.RegistraId"></select>
                <span asp-validation-for="SinglePrescrip" class="text-danger"></span>

                <table id="dataTable" class="table table-bordered mt-3">
                    <thead>
                        <tr>
                            <th>চিপ কমপ্লেইন</th>
                            <th>জেনারেল</th>
                            <th>ডায়াগ</th>
                            <th>ইনভেস্ট</th>
                            <th>মেডি</th>
                            <th>ডোজেস</th>
                            <th>এডভাইস</th>
                            <th>ফ্লো</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <select name="Prescriptions[0].ChiefComplaintId" class="form-control select2">
                                    <option value="">-- Select --</option>
                                    @foreach (var item in ViewData["ChiefComplaintId"] as SelectList)
                                    {
                                        <option value="@item.Value">@item.Text</option>
                                    }
                                </select>
                            </td>
                            <td>
                                <select name="Prescriptions[0].GeneralExaminationId" class="form-control select2">
                                    <option value="">-- Select --</option>
                                    @foreach (var item in ViewData["GeneralExaminationId"] as SelectList)
                                    {
                                        <option value="@item.Value">@item.Text</option>
                                    }
                                </select>
                            </td>

                            <td>
                                <select name="Prescriptions[0].DiagnosisId" class="form-control select2">
                                    <option value="">-- Select --</option>
                                    @foreach (var item in ViewData["DiagnosisId"] as SelectList)
                                    {
                                        <option value="@item.Value">@item.Text</option>
                                    }
                                </select>
                            </td>
                            <td>
                                <select name="Prescriptions[0].InvastigationId" class="form-control select2">
                                    <option value="">-- Select --</option>
                                    @foreach (var item in ViewData["InvastigationId"] as SelectList)
                                    {
                                        <option value="@item.Value">@item.Text</option>
                                    }
                                </select>
                            </td>
                            <td>
                                <select name="Prescriptions[0].MedicineId" class="form-control select2">
                                    <option value="">-- Select --</option>
                                    @foreach (var item in ViewData["MedicineId"] as SelectList)
                                    {
                                        <option value="@item.Value">@item.Text</option>
                                    }
                                </select>
                            </td>
                            <td>
                                <select name="Prescriptions[0].DosesId" class="form-control select2">
                                    <option value="">-- Select --</option>
                                    @foreach (var item in ViewData["DosesId"] as SelectList)
                                    {
                                        <option value="@item.Value">@item.Text</option>
                                    }
                                </select>
                            </td>
                            
                            <td>
                                <select name="Prescriptions[0].AdviceId" class="form-control select2">
                                    <option value="">-- Select --</option>
                                    @foreach (var item in ViewData["AdviceId"] as SelectList)
                                    {
                                        <option value="@item.Value">@item.Text</option>
                                    }
                                </select>
                            </td>
                            <td>
                                <select name="Prescriptions[0].FlowUpId" class="form-control select2">
                                    <option value="">-- Select --</option>
                                    @foreach (var item in ViewData["FlowUpId"] as SelectList)
                                    {
                                        <option value="@item.Value">@item.Text</option>
                                    }
                                </select>
                            </td>

                   
                            <td><input type="button" id="addNew" value="+" class="btn btn-primary" /></td>
                        </tr>
                    </tbody>
                </table>

                <div class="mt-4">
                    <input type="submit" value="Create" class="btn btn-primary" />
                </div>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
    <script>
        $(document).ready(function () {
            $('.select2').select2();
            $('#addNew').click(function () {
                var index = $('#dataTable tbody tr').length;
                var newRow = `
                            <tr>
                                <td>
                                    <select name="Prescriptions[${index}].ChiefComplaintId" class="form-control select2">
                                        <option value="">-- Select --</option>
                                        @foreach (var item in ViewData["ChiefComplaintId"] as SelectList)
                                        {
                                                <option value="@item.Value">@item.Text</option>
                                        }
                                    </select>
                                </td>

                                  <td>
                                    <select name="Prescriptions[${index}].GeneralExaminationId" class="form-control select2">
                                                <option value="">-- Select --</option>
                                               @foreach (var item in ViewData["GeneralExaminationId"] as SelectList)
                                                {
                                                    <option value="@item.Value">@item.Text</option>
                                                }
                                            </select>
                                  </td>
                                  
                                  <td>
                                       <select name="Prescriptions[${index}].DiagnosisId" class="form-control select2">
                                        <option value="">-- Select --</option>
                                        @foreach (var item in ViewData["DiagnosisId"] as SelectList)
                                        {
                                                <option value="@item.Value">@item.Text</option>
                                        }
                                    </select>
                                </td>

                                  <td>
                                       <select name="Prescriptions[${index}].InvastigationId" class="form-control select2">
                                                <option value="">-- Select --</option>
                                               @foreach (var item in ViewData["InvastigationId"] as SelectList)
                                                {
                                                    <option value="@item.Value">@item.Text</option>
                                                }
                                            </select>
                                  </td>
                                   <td>
                                            <select name="Prescriptions[${index}].MedicineId" class="form-control select2">
                                        <option value="">-- Select --</option>
                                        @foreach (var item in ViewData["MedicineId"] as SelectList)
                                        {
                                                <option value="@item.Value">@item.Text</option>
                                        }
                                    </select>
                                </td>

                                  <td>
                                  <select name="Prescriptions[${index}].DosesId" class="form-control select2">
                                                <option value="">-- Select --</option>
                                           @foreach (var item in ViewData["DosesId"] as SelectList)
                                                                         {
                                                                             <option value="@item.Value">@item.Text</option>
                                                                         }
                                                                     </select>
                                     </td>
                                                           
                                        <td>
                                       <select name="Prescriptions[${index}].AdviceId" class="form-control select2">
                                                    <option value="">-- Select --</option>
                                              @foreach (var item in ViewData["AdviceId"] as SelectList)
                                               {
                                                    <option value="@item.Value">@item.Text</option>
                                              }
                                         </select>
                                       </td>
                                
                                       <td>
                                            <select name="Prescriptions[${index}].FlowUpId" class="form-control select2">
                                                  <option value="">-- Select --</option>
                                              @foreach (var item in ViewData["FlowUpId"] as SelectList)
                                                {
                                                    <option value="@item.Value">@item.Text</option>
                                                }
                                            </select>
                                         </td>




                                <!-- Similar dropdowns for other fields -->

                                <td><input type="button" class="btn btn-danger remove" value="-" /></td>
                            </tr>`;
                $('#dataTable tbody').append(newRow);
                $('.select2').select2();
            });

            $('#dataTable').on('click', '.remove', function () {
                $(this).closest('tr').remove();
            });
        });
    </script>
}
